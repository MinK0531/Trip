<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/default_head}">

<div layout:fragment="fragment">
    <div id="chartdiv">
        <div class="profile-card-container">
            <div class="boarding-pass">
                <div class="top-stripe" >
                    <img src="/img/top-stripe.png"
                         alt="í”„ë¡œí•„ ë¨¸ë¦¬">
                </div>

                <div class="pass-content">
                    <div class="top-section">
                        <div class="profile-pic-wrapper ">
                            <img src="/img/profile.png" alt="Profile" class="profile-pic">
                        </div>

                        <div>
                            <button class="edit-btn ">í”„ë¡œí•„ í¸ì§‘</button>
                            <div class="plane-icon">
                                <svg viewBox="0 0 24 24">
                                    <path d="M21 16v-2l-8-5V3.5c0-.83-.67-1.5-1.5-1.5S10 2.67 10 3.5V9l-8 5v2l8-2.5V19l-2 1.5V22l3.5-1 3.5 1v-1.5L13 19v-5.5l8 2.5z"/>
                                </svg>
                            </div>
                        </div>

                    </div>

                    <div class="flight-info-row">
                        <div class="airport-code">KOR</div>
                        <div class="flight-details">
                            <div class="detail-item ">
                                <div class="label">FLIGHT</div>
                                <div class="value">5</div>
                            </div>
                            <div class="detail-item">
                                <div class="label">GATE</div>
                                <div class="value">2</div>
                            </div>
                        </div>
                    </div>



                    <h1 class="destination">SEOUL</h1>
                    <p class="airline-name">í•­ê³µì‚¬ ì´ë¦„ :<span th:text="${session.userSigninId}" class="font-weight-bold"></span></p>

                    <div class="divider"></div>

                    <div class="bottom-section">
                        <div class="user-stats">
                            <h2 class="comment-title">í•œë§ˆë””..</h2>
                            <div class="stat-row">
                                <span class="stat-label">Following</span>
                                <span class="stat-count">123</span>
                            </div>
                            <div class="stat-row">
                                <span class="stat-label">Follower</span>
                                <span class="stat-count">456</span>
                            </div>
                        </div>
                        <div class="qr-code-wrapper">
                            <div class="qr-mock">
                                <div class="qr-eyes">ğŸ‘€</div>
                                <div class="qr-num">3</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="modal-overlay" onclick="closeModal()"></div>
    <div id="modal">
        <h3 id="modal-title">ìƒˆë¡œìš´ í•€ ì •ë³´</h3>
        <p id="modal-desc"></p>
        <button class="close-btn" onclick="closeModal()">ë‹«ê¸°</button>
    </div>
</div>

<script layout:fragment="script">
    const COUNTRY_KO = {
        AF: "ì•„í”„ê°€ë‹ˆìŠ¤íƒ„",
        AX: "ì˜¬ë€ë“œ ì œë„",
        AL: "ì•Œë°”ë‹ˆì•„",
        DZ: "ì•Œì œë¦¬",
        AS: "ì•„ë©”ë¦¬ì¹¸ì‚¬ëª¨ì•„",
        AD: "ì•ˆë„ë¼",
        AO: "ì•™ê³¨ë¼",
        AI: "ì•µê·ˆë¼",
        AQ: "ë‚¨ê·¹",
        AG: "ì•¤í‹°ê°€ ë°”ë¶€ë‹¤",
        AR: "ì•„ë¥´í—¨í‹°ë‚˜",
        AM: "ì•„ë¥´ë©”ë‹ˆì•„",
        AW: "ì•„ë£¨ë°”",
        AU: "í˜¸ì£¼",
        AT: "ì˜¤ìŠ¤íŠ¸ë¦¬ì•„",
        AZ: "ì•„ì œë¥´ë°”ì´ì”",

        BS: "ë°”í•˜ë§ˆ",
        BH: "ë°”ë ˆì¸",
        BD: "ë°©ê¸€ë¼ë°ì‹œ",
        BB: "ë°”ë² ì´ë„ìŠ¤",
        BY: "ë²¨ë¼ë£¨ìŠ¤",
        BE: "ë²¨ê¸°ì—",
        BZ: "ë²¨ë¦¬ì¦ˆ",
        BJ: "ë² ëƒ‰",
        BM: "ë²„ë®¤ë‹¤",
        BT: "ë¶€íƒ„",
        BO: "ë³¼ë¦¬ë¹„ì•„",
        BQ: "ë³´ë„¤ë¥´ ì‹ íŠ¸ì™¸ìŠ¤íƒ€í‹°ìœ„ìŠ¤ ì‚¬ë°”",
        BA: "ë³´ìŠ¤ë‹ˆì•„ í—¤ë¥´ì²´ê³ ë¹„ë‚˜",
        BW: "ë³´ì¸ ì™€ë‚˜",
        BV: "ë¶€ë²  ì„¬",
        BR: "ë¸Œë¼ì§ˆ",
        IO: "ì˜êµ­ë ¹ ì¸ë„ì–‘ ì§€ì—­",
        BN: "ë¸Œë£¨ë‚˜ì´",
        BG: "ë¶ˆê°€ë¦¬ì•„",
        BF: "ë¶€ë¥´í‚¤ë‚˜íŒŒì†Œ",
        BI: "ë¶€ë£¬ë””",

        KH: "ìº„ë³´ë””ì•„",
        CM: "ì¹´ë©”ë£¬",
        CA: "ìºë‚˜ë‹¤",
        CV: "ì¹´ë³´ë² ë¥´ë°",
        KY: "ì¼€ì´ë§¨ ì œë„",
        CF: "ì¤‘ì•™ì•„í”„ë¦¬ì¹´ê³µí™”êµ­",
        TD: "ì°¨ë“œ",
        CL: "ì¹ ë ˆ",
        CN: "ì¤‘êµ­",
        CX: "í¬ë¦¬ìŠ¤ë§ˆìŠ¤ ì„¬",
        CC: "ì½”ì½”ìŠ¤ ì œë„",
        CO: "ì½œë¡¬ë¹„ì•„",
        KM: "ì½”ëª¨ë¡œ",
        CG: "ì½©ê³ ",
        CD: "ì½©ê³  ë¯¼ì£¼ ê³µí™”êµ­",
        CK: "ì¿¡ ì œë„",
        CR: "ì½”ìŠ¤íƒ€ë¦¬ì¹´",
        CI: "ì½”íŠ¸ë””ë¶€ì•„ë¥´",
        HR: "í¬ë¡œì•„í‹°ì•„",
        CU: "ì¿ ë°”",
        CW: "í€´ë¼ì†Œ",
        CY: "í‚¤í”„ë¡œìŠ¤",
        CZ: "ì²´ì½”",

        DK: "ë´ë§ˆí¬",
        DJ: "ì§€ë¶€í‹°",
        DM: "ë„ë¯¸ë‹ˆì¹´",
        DO: "ë„ë¯¸ë‹ˆì¹´ ê³µí™”êµ­",

        EC: "ì—ì½°ë„ë¥´",
        EG: "ì´ì§‘íŠ¸",
        SV: "ì—˜ì‚´ë°”ë„ë¥´",
        GQ: "ì ë„ ê¸°ë‹ˆ",
        ER: "ì—ë¦¬íŠ¸ë ˆì•„",
        EE: "ì—ìŠ¤í† ë‹ˆì•„",
        SZ: "ì—ìŠ¤ì™€í‹°ë‹ˆ",
        ET: "ì—í‹°ì˜¤í”¼ì•„",

        FK: "í¬í´ëœë“œ ì œë„",
        FO: "í˜ë¡œ ì œë„",
        FJ: "í”¼ì§€",
        FI: "í•€ë€ë“œ",
        FR: "í”„ë‘ìŠ¤",

        GF: "í”„ë‘ìŠ¤ë ¹ ê¸°ì•„ë‚˜",
        PF: "í”„ë‘ìŠ¤ë ¹ í´ë¦¬ë„¤ì‹œì•„",
        TF: "í”„ë‘ìŠ¤ë ¹ ë‚¨ë°© ë° ë‚¨ê·¹ ì§€ì—­",

        GA: "ê°€ë´‰",
        GM: "ê°ë¹„ì•„",
        GE: "ì¡°ì§€ì•„",
        DE: "ë…ì¼",
        GH: "ê°€ë‚˜",
        GI: "ì§€ë¸Œë¡¤í„°",
        GR: "ê·¸ë¦¬ìŠ¤",
        GL: "ê·¸ë¦°ë€ë“œ",
        GD: "ê·¸ë ˆë‚˜ë‹¤",
        GP: "ê³¼ë“¤ë£¨í”„",
        GU: "ê´Œ",
        GT: "ê³¼í…Œë§ë¼",
        GG: "ê±´ì§€",
        GN: "ê¸°ë‹ˆ",
        GW: "ê¸°ë‹ˆë¹„ì‚¬ìš°",
        GY: "ê°€ì´ì•„ë‚˜",

        HT: "ì•„ì´í‹°",
        HM: "í—ˆë“œ ë§¥ë„ë„ë“œ ì œë„",
        VA: "ë°”í‹°ì¹¸ ì‹œêµ­",
        HN: "ì˜¨ë‘ë¼ìŠ¤",
        HK: "í™ì½©",
        HU: "í—ê°€ë¦¬",

        IS: "ì•„ì´ìŠ¬ë€ë“œ",
        IN: "ì¸ë„",
        ID: "ì¸ë„ë„¤ì‹œì•„",
        IR: "ì´ë€",
        IQ: "ì´ë¼í¬",
        IE: "ì•„ì¼ëœë“œ",
        IM: "ë§¨ ì„¬",
        IL: "ì´ìŠ¤ë¼ì—˜",
        IT: "ì´íƒˆë¦¬ì•„",

        JM: "ìë©”ì´ì¹´",
        JP: "ì¼ë³¸",
        JE: "ì €ì§€",
        JO: "ìš”ë¥´ë‹¨",

        KZ: "ì¹´ìíìŠ¤íƒ„",
        KE: "ì¼€ëƒ",
        KI: "í‚¤ë¦¬ë°”ì‹œ",
        KP: "ë¶í•œ",
        KR: "ëŒ€í•œë¯¼êµ­",
        KW: "ì¿ ì›¨ì´íŠ¸",
        KG: "í‚¤ë¥´ê¸°ìŠ¤ìŠ¤íƒ„",

        LA: "ë¼ì˜¤ìŠ¤",
        LV: "ë¼íŠ¸ë¹„ì•„",
        LB: "ë ˆë°”ë…¼",
        LS: "ë ˆì†Œí† ",
        LR: "ë¼ì´ë² ë¦¬ì•„",
        LY: "ë¦¬ë¹„ì•„",
        LI: "ë¦¬íˆí…ìŠˆíƒ€ì¸",
        LT: "ë¦¬íˆ¬ì•„ë‹ˆì•„",
        LU: "ë£©ì…ˆë¶€ë¥´í¬",

        MO: "ë§ˆì¹´ì˜¤",
        MG: "ë§ˆë‹¤ê°€ìŠ¤ì¹´ë¥´",
        MW: "ë§ë¼ìœ„",
        MY: "ë§ë ˆì´ì‹œì•„",
        MV: "ëª°ë””ë¸Œ",
        ML: "ë§ë¦¬",
        MT: "ëª°íƒ€",
        MH: "ë§ˆì…œ ì œë„",
        MQ: "ë§ˆë¥´í‹°ë‹ˆí¬",
        MR: "ëª¨ë¦¬íƒ€ë‹ˆ",
        MU: "ëª¨ë¦¬ì…”ìŠ¤",
        YT: "ë§ˆìš”íŠ¸",
        MX: "ë©•ì‹œì½”",
        FM: "ë¯¸í¬ë¡œë„¤ì‹œì•„",
        MD: "ëª°ë„ë°”",
        MC: "ëª¨ë‚˜ì½”",
        MN: "ëª½ê³¨",
        ME: "ëª¬í…Œë„¤ê·¸ë¡œ",
        MS: "ëª¬íŠ¸ì„¸ë«",
        MA: "ëª¨ë¡œì½”",
        MZ: "ëª¨ì ë¹„í¬",
        MM: "ë¯¸ì–€ë§ˆ",

        NA: "ë‚˜ë¯¸ë¹„ì•„",
        NR: "ë‚˜ìš°ë£¨",
        NP: "ë„¤íŒ”",
        NL: "ë„¤ëœë€ë“œ",
        NC: "ëˆ„ë²¨ì¹¼ë ˆë„ë‹ˆ",
        NZ: "ë‰´ì§ˆëœë“œ",
        NI: "ë‹ˆì¹´ë¼ê³¼",
        NE: "ë‹ˆì œë¥´",
        NG: "ë‚˜ì´ì§€ë¦¬ì•„",
        NU: "ë‹ˆìš°ì—",
        NF: "ë…¸í½ ì„¬",
        MK: "ë¶ë§ˆì¼€ë„ë‹ˆì•„",
        MP: "ë¶ë§ˆë¦¬ì•„ë‚˜ ì œë„",
        NO: "ë…¸ë¥´ì›¨ì´",

        OM: "ì˜¤ë§Œ",

        PK: "íŒŒí‚¤ìŠ¤íƒ„",
        PW: "íŒ”ë¼ìš°",
        PS: "íŒ”ë ˆìŠ¤íƒ€ì¸",
        PA: "íŒŒë‚˜ë§ˆ",
        PG: "íŒŒí‘¸ì•„ë‰´ê¸°ë‹ˆ",
        PY: "íŒŒë¼ê³¼ì´",
        PE: "í˜ë£¨",
        PH: "í•„ë¦¬í•€",
        PN: "í•ì¼€ì–¸ ì œë„",
        PL: "í´ë€ë“œ",
        PT: "í¬ë¥´íˆ¬ê°ˆ",
        PR: "í‘¸ì—ë¥´í† ë¦¬ì½”",

        QA: "ì¹´íƒ€ë¥´",

        RE: "ë ˆìœ„ë‹ˆì˜¹",
        RO: "ë£¨ë§ˆë‹ˆì•„",
        RU: "ëŸ¬ì‹œì•„",
        RW: "ë¥´ì™„ë‹¤",

        BL: "ìƒë°”ë¥´í…”ë ˆë¯¸",
        SH: "ì„¸ì¸íŠ¸í—¬ë ˆë‚˜",
        KN: "ì„¸ì¸íŠ¸í‚¤ì¸  ë„¤ë¹„ìŠ¤",
        LC: "ì„¸ì¸íŠ¸ë£¨ì‹œì•„",
        MF: "ìƒë§ˆë¥´íƒ±",
        PM: "ìƒí”¼ì—ë¥´ ë¯¸í´ë¡±",
        VC: "ì„¸ì¸íŠ¸ë¹ˆì„¼íŠ¸ ê·¸ë ˆë‚˜ë”˜",
        WS: "ì‚¬ëª¨ì•„",
        SM: "ì‚°ë§ˆë¦¬ë…¸",
        ST: "ìƒíˆ¬ë©” í”„ë¦°ì‹œí˜",
        SA: "ì‚¬ìš°ë””ì•„ë¼ë¹„ì•„",
        SN: "ì„¸ë„¤ê°ˆ",
        RS: "ì„¸ë¥´ë¹„ì•„",
        SC: "ì„¸ì´ì…¸",
        SL: "ì‹œì—ë¼ë¦¬ì˜¨",
        SG: "ì‹±ê°€í¬ë¥´",
        SX: "ì‹ íŠ¸ë§ˆë¥´í„´",
        SK: "ìŠ¬ë¡œë°”í‚¤ì•„",
        SI: "ìŠ¬ë¡œë² ë‹ˆì•„",
        SB: "ì†”ë¡œëª¬ ì œë„",
        SO: "ì†Œë§ë¦¬ì•„",
        ZA: "ë‚¨ì•„í”„ë¦¬ì¹´ê³µí™”êµ­",
        GS: "ì‚¬ìš°ìŠ¤ì¡°ì§€ì•„ ì‚¬ìš°ìŠ¤ìƒŒë“œìœ„ì¹˜ ì œë„",
        SS: "ë‚¨ìˆ˜ë‹¨",
        ES: "ìŠ¤í˜ì¸",
        LK: "ìŠ¤ë¦¬ë‘ì¹´",
        SD: "ìˆ˜ë‹¨",
        SR: "ìˆ˜ë¦¬ë‚¨",
        SJ: "ìŠ¤ë°œë°”ë¥´ ì–€ë§ˆì˜Œ",
        SE: "ìŠ¤ì›¨ë´",
        CH: "ìŠ¤ìœ„ìŠ¤",
        SY: "ì‹œë¦¬ì•„",

        TW: "ëŒ€ë§Œ",
        TJ: "íƒ€ì§€í‚¤ìŠ¤íƒ„",
        TZ: "íƒ„ìë‹ˆì•„",
        TH: "íƒœêµ­",
        TL: "ë™í‹°ëª¨ë¥´",
        TG: "í† ê³ ",
        TK: "í† ì¼ˆë¼ìš°",
        TO: "í†µê°€",
        TT: "íŠ¸ë¦¬ë‹ˆë‹¤ë“œ í† ë°”ê³ ",
        TN: "íŠ€ë‹ˆì§€",
        TR: "íŠ€ë¥´í‚¤ì˜ˆ",
        TM: "íˆ¬ë¥´í¬ë©”ë‹ˆìŠ¤íƒ„",
        TC: "í„°í¬ìŠ¤ ì¼€ì´ì»¤ìŠ¤ ì œë„",
        TV: "íˆ¬ë°œë£¨",

        UG: "ìš°ê°„ë‹¤",
        UA: "ìš°í¬ë¼ì´ë‚˜",
        AE: "ì•„ëì—ë¯¸ë¦¬íŠ¸",
        GB: "ì˜êµ­",
        US: "ë¯¸êµ­",
        UM: "ë¯¸êµ­ë ¹ êµ°ì†Œ ì œë„",
        UY: "ìš°ë£¨ê³¼ì´",
        UZ: "ìš°ì¦ˆë² í‚¤ìŠ¤íƒ„",

        VU: "ë°”ëˆ„ì•„íˆ¬",
        VE: "ë² ë„¤ìˆ˜ì—˜ë¼",
        VN: "ë² íŠ¸ë‚¨",
        VG: "ì˜êµ­ë ¹ ë²„ì§„ì•„ì¼ëœë“œ",
        VI: "ë¯¸êµ­ë ¹ ë²„ì§„ì•„ì¼ëœë“œ",

        WF: "ì™ˆë¦¬ìŠ¤ í‘¸íˆ¬ë‚˜",
        EH: "ì„œì‚¬í•˜ë¼",

        YE: "ì˜ˆë©˜",
        ZM: "ì ë¹„ì•„",
        ZW: "ì§ë°”ë¸Œì›¨",
        XK: "ì½”ì†Œë³´"
    };

    am5.ready(function() {
        var root = am5.Root.new("chartdiv");
        root.setThemes([am5themes_Animated.new(root)]);


        var chart = root.container.children.push(am5map.MapChart.new(root, {
            panX: "rotateX",
            panY: "rotateY",
            projection: am5map.geoOrthographic(),
            paddingBottom: 20, paddingTop: 20, paddingLeft: 20, paddingRight: 20
        }));

        // ë°”ë‹¤
        var backgroundSeries = chart.series.push(am5map.MapPolygonSeries.new(root, {}));
        backgroundSeries.mapPolygons.template.setAll({ fill: am5.color(0xE5E5E5), fillOpacity: 0.5, strokeOpacity: 0 });
        backgroundSeries.data.push({ geometry: am5map.getGeoRectangle(90, 180, -90, -180) });

        var graticuleSeries = chart.series.push(am5map.GraticuleSeries.new(root, {}));
        graticuleSeries.mapLines.template.setAll({
            stroke: am5.color(0x000000),
            strokeOpacity: 0.08,
            strokeWidth: 0.5
        });

        var polygonSeries = chart.series.push(am5map.MapPolygonSeries.new(root, {
            geoJSON: am5geodata_worldLow
        }));
        polygonSeries.events.on("datavalidated", function() {
            am5.array.each(polygonSeries.dataItems, function(dataItem) {
                var id = dataItem.get("id");
                if (COUNTRY_KO[id]) {
                    dataItem.set("name", COUNTRY_KO[id]);
                }
            });
        });

        // êµ­ê°€(ìœ¡ì§€)
        var polygonSeries = chart.series.push(am5map.MapPolygonSeries.new(root, { geoJSON: am5geodata_worldLow }));
        polygonSeries.mapPolygons.template.setAll({
            fill: am5.color(0x5C85C6),
            stroke: am5.color(0xffffff),
            strokeWidth: 0.8,
            tooltipText: "{name}",
            interactive: true
        });
        polygonSeries.mapPolygons.template.states.create("hover", {
            fill: am5.color(0x4A6FA5)
        });

        var pointSeries = chart.series.push(am5map.MapPointSeries.new(root, {}));
        pointSeries.bullets.push(function() {
            var circle = am5.Circle.new(root, {
                radius: 6,
                fill: am5.color(0xff0000),
                stroke: am5.color(0xffffff),
                strokeWidth: 2,
                cursorOverStyle: "pointer",
                tooltipText: "í´ë¦­í•˜ì—¬ ì •ë³´ ë³´ê¸°"
            });

            // í•€ í´ë¦­ ì´ë²¤íŠ¸: ëª¨ë‹¬ í‘œì‹œ
            circle.events.on("click", function(ev) {
                var data = ev.target.dataItem.dataContext;
                openModal(data.title, `ìœ„ë„: ${data.latitude.toFixed(2)}<br>ê²½ë„: ${data.longitude.toFixed(2)}`);
            });

            return am5.Bullet.new(root, { sprite: circle });
        });

        chart.events.on("dblclick", function(ev) {
            // í´ë¦­í•œ ìœ„ì¹˜ì˜ ì¢Œí‘œ(ìœ„ë„, ê²½ë„) ê³„ì‚°
            var geoPoint = chart.invert(ev.point);

            if (geoPoint) {
                // í•€ ë°ì´í„° ì¶”ê°€
                pointSeries.data.push({
                    geometry: { type: "Point", coordinates: [geoPoint.longitude, geoPoint.latitude] },
                    title: "ë‚´ê°€ ì¶”ê°€í•œ ì¥ì†Œ",
                    latitude: geoPoint.latitude,
                    longitude: geoPoint.longitude
                });
                console.log("í•€ ì¶”ê°€ë¨:", geoPoint);
            }
        });

        // ìë™ íšŒì „ (í•€ ì¶”ê°€ë¥¼ í¸í•˜ê²Œ í•˜ë ¤ë©´ í•„ìš” ì‹œ ì¤‘ë‹¨ ê°€ëŠ¥)
        var animation = chart.animate({ key: "rotationX", from: 0, to: 360, duration: 60000, loops: Infinity });

        chart.appear(1000, 100);
    });

    // ëª¨ë‹¬ ì œì–´ í•¨ìˆ˜
    function openModal(title, desc) {
        document.getElementById("modal-title").innerHTML = title;
        document.getElementById("modal-desc").innerHTML = desc;
        document.getElementById("modal").style.display = "block";
        document.getElementById("modal-overlay").style.display = "block";
    }

    function closeModal() {
        document.getElementById("modal").style.display = "none";
        document.getElementById("modal-overlay").style.display = "none";
    }
</script>
</body>
</html>